# Информационно-справочная система театра

Курсовая работа по разработке веб-приложения для управления театральной системой.

## Технологический стек

- **Java 17**
- **Spring Boot 3.2.0**
- **Spring Security** - для авторизации и аутентификации
- **Spring Data JPA / Hibernate** - для работы с базой данных
- **MySQL** - база данных
- **Thymeleaf** - шаблонизатор для веб-интерфейса
- **Bootstrap 5** - для UI
- **Maven** - система сборки

## Функциональные возможности

### 1. Регистрация и авторизация
- Регистрация новых пользователей
- Авторизация в системе
- Разграничение доступа по ролям

### 2. Управление данными (CRUD)
- **Спектакли**: создание, просмотр, редактирование, удаление
- **Актеры**: создание, просмотр, редактирование, удаление
- **Залы**: создание, просмотр, редактирование, удаление
- **Билеты**: покупка, просмотр, удаление

### 3. Поиск и сортировка
- Поиск спектаклей по названию и описанию
- Поиск актеров по имени и фамилии
- Поиск залов по названию
- Сортировка по различным критериям (дата, цена, название и т.д.)

### 4. Роли пользователей

#### VIEWER (Зритель)
- Просмотр спектаклей
- Просмотр информации об актерах
- Просмотр информации о залах
- Покупка билетов
- Просмотр своих билетов
- Редактирование личной информации

#### CASHIER (Кассир)
- Все возможности зрителя
- Управление залами (создание, редактирование, удаление)
- Просмотр всех билетов

#### DIRECTOR (Режиссер)
- Все возможности зрителя
- Управление спектаклями (создание, редактирование, удаление)
- Управление актерами (создание, редактирование, удаление)
- Управление залами

#### ADMIN (Администратор)
- Все возможности других ролей
- Управление пользователями
- Изменение ролей пользователей
- Полный доступ ко всем функциям системы

## Установка и запуск

### Требования
- Java 17 или выше
- Maven 3.6+
- MySQL 8.0+

### Шаги установки

1. **Клонирование репозитория** (если используется Git)
   ```bash
   git clone <repository-url>
   cd diana2
   ```

2. **Настройка базы данных**
   
   Создайте базу данных MySQL:
   ```sql
   CREATE DATABASE theater_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```
   
   Или база данных будет создана автоматически при первом запуске (если указано `createDatabaseIfNotExist=true`).

3. **Настройка подключения к БД**
   
   Отредактируйте файл `src/main/resources/application.properties`:
   ```properties
   spring.datasource.url=jdbc:mysql://localhost:3306/theater_db?createDatabaseIfNotExist=true&useSSL=false&serverTimezone=UTC&characterEncoding=UTF-8
   spring.datasource.username=root
   spring.datasource.password=your_password
   ```
   
   Замените `your_password` на ваш пароль MySQL.

4. **Сборка проекта**
   ```bash
   mvn clean install
   ```

5. **Запуск приложения**
   ```bash
   mvn spring-boot:run
   ```
   
   Или запустите класс `TheaterApplication` из IDE.

6. **Доступ к приложению**
   
   Откройте браузер и перейдите по адресу:
   ```
   http://localhost:8080
   ```

## Первоначальная настройка

При первом запуске система автоматически создаст роли:
- VIEWER
- CASHIER
- DIRECTOR
- ADMIN

### Создание администратора

Для создания первого администратора:

1. Зарегистрируйтесь как обычный пользователь через форму регистрации
2. Войдите в систему под учетной записью администратора (если она уже создана)
3. Перейдите в раздел "Управление пользователями"
4. Измените роль пользователя на ADMIN

Или создайте администратора напрямую в базе данных:

```sql
-- Сначала создайте пользователя через форму регистрации, затем выполните:
INSERT INTO user_roles (user_id, role_id) 
SELECT u.id, r.id 
FROM users u, roles r 
WHERE u.username = 'your_username' AND r.name = 'ADMIN';
```

## Структура проекта

```
src/
├── main/
│   ├── java/
│   │   └── ru/theater/
│   │       ├── TheaterApplication.java      # Главный класс приложения
│   │       ├── config/                      # Конфигурационные классы
│   │       │   ├── SecurityConfig.java     # Настройки безопасности
│   │       │   ├── DataInitializer.java    # Инициализация данных
│   │       │   └── WebConfig.java          # Настройки веб-слоя
│   │       ├── controller/                 # Контроллеры
│   │       │   ├── MainController.java
│   │       │   ├── RegistrationController.java
│   │       │   ├── PerformanceController.java
│   │       │   ├── ActorController.java
│   │       │   ├── HallController.java
│   │       │   ├── TicketController.java
│   │       │   └── AdminController.java
│   │       ├── entity/                      # Сущности JPA
│   │       │   ├── User.java
│   │       │   ├── Role.java
│   │       │   ├── Performance.java
│   │       │   ├── Actor.java
│   │       │   ├── Hall.java
│   │       │   └── Ticket.java
│   │       ├── repository/                 # Репозитории
│   │       │   ├── UserRepository.java
│   │       │   ├── RoleRepository.java
│   │       │   ├── PerformanceRepository.java
│   │       │   ├── ActorRepository.java
│   │       │   ├── HallRepository.java
│   │       │   └── TicketRepository.java
│   │       └── service/                    # Сервисы
│   │           ├── UserService.java
│   │           ├── PerformanceService.java
│   │           ├── ActorService.java
│   │           ├── HallService.java
│   │           └── TicketService.java
│   └── resources/
│       ├── application.properties          # Конфигурация приложения
│       └── templates/                       # HTML шаблоны
│           ├── login.html
│           ├── register.html
│           ├── home.html
│           ├── performances/
│           ├── actors/
│           ├── halls/
│           ├── tickets/
│           └── admin/
└── pom.xml                                  # Maven конфигурация
```

## Использование системы

### Для зрителя (VIEWER)
1. Зарегистрируйтесь или войдите в систему
2. Просматривайте доступные спектакли
3. Покупайте билеты на понравившиеся спектакли
4. Просматривайте свои билеты в разделе "Мои билеты"
5. Редактируйте личную информацию

### Для кассира (CASHIER)
1. Все возможности зрителя
2. Управление залами театра
3. Просмотр информации о билетах

### Для режиссера (DIRECTOR)
1. Все возможности зрителя
2. Управление спектаклями
3. Управление актерами
4. Управление залами

### Для администратора (ADMIN)
1. Все возможности других ролей
2. Управление пользователями системы
3. Изменение ролей пользователей

## Особенности реализации

- **Безопасность**: Spring Security обеспечивает защиту от несанкционированного доступа
- **Валидация**: Проверка данных на стороне сервера
- **ORM**: Использование JPA/Hibernate для работы с БД
- **RESTful архитектура**: Логичная структура URL
- **Адаптивный дизайн**: Интерфейс работает на различных устройствах

## Возможные улучшения

- Добавление связи между спектаклями и актерами (многие ко многим)
- Реализация расписания спектаклей
- Добавление системы бронирования мест
- Экспорт данных в различные форматы
- Добавление API для мобильных приложений
- Реализация системы уведомлений

## Автор

Курсовая работа по дисциплине "Разработка информационных систем"

## Лицензия

Учебный проект

